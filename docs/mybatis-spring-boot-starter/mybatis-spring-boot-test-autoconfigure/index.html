<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.7.4 at 21 August 2017 
 | Rendered using Apache Maven Fluido Skin 1.6
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="author" content="Kazuki Shimizu" />
    <meta name="Date-Revision-yyyymmdd" content="20170821" />
    <meta http-equiv="Content-Language" content="en" />
    <title>mybatis-spring-boot-test-autoconfigure &#x2013; MyBatis Sring-Boot-Starter-Test | Reference Documentation</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.6.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
      <script type="text/javascript" src="./js/apache-maven-fluido-1.6.min.js"></script>
      </head>
    <body class="topBarDisabled">
      <div class="container-fluid">
      <div id="banner">
        <div class="pull-left"><div id="bannerLeft"><h2>mybatis-spring-boot-test-autoconfigure</h2>
</div>
</div>
        <div class="pull-right"><a href="../../" id="bannerRight" title="MyBatis logo"><img src="../../images/mybatis-logo.png"  alt="MyBatis logo"/></a></div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
        <li id="publishDate">Last Published: 21 August 2017<span class="divider">|</span>
</li>
          <li id="projectVersion">Version: 2.0.0-SNAPSHOT</li>
        </ul>
      </div>
      <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
<ul class="nav nav-list">
          <li class="nav-header">Reference Documentation</li>
    <li class="active"><a href="#"><span class="none"></span>Introduction</a>
  </li>
          <li class="nav-header">Project Documentation</li>
    <li><a href="project-info.html" title="Project Information"><span class="icon-chevron-down"></span>Project Information</a>
      <ul class="nav nav-list">
    <li><a href="integration.html" title="CI Management"><span class="none"></span>CI Management</a>  </li>
    <li><a href="dependencies.html" title="Dependencies"><span class="none"></span>Dependencies</a>  </li>
    <li><a href="dependency-info.html" title="Dependency Information"><span class="none"></span>Dependency Information</a>  </li>
    <li><a href="dependency-management.html" title="Dependency Management"><span class="none"></span>Dependency Management</a>  </li>
    <li><a href="distribution-management.html" title="Distribution Management"><span class="none"></span>Distribution Management</a>  </li>
    <li class="active"><a href="#"><span class="none"></span>About</a>
  </li>
    <li><a href="issue-tracking.html" title="Issue Management"><span class="none"></span>Issue Management</a>  </li>
    <li><a href="license.html" title="Licenses"><span class="none"></span>Licenses</a>  </li>
    <li><a href="mail-lists.html" title="Mailing Lists"><span class="none"></span>Mailing Lists</a>  </li>
    <li><a href="plugin-management.html" title="Plugin Management"><span class="none"></span>Plugin Management</a>  </li>
    <li><a href="plugins.html" title="Plugins"><span class="none"></span>Plugins</a>  </li>
    <li><a href="team-list.html" title="Team"><span class="none"></span>Team</a>  </li>
    <li><a href="source-repository.html" title="Source Code Management"><span class="none"></span>Source Code Management</a>  </li>
    <li><a href="project-summary.html" title="Summary"><span class="none"></span>Summary</a>  </li>
      </ul>
  </li>
    <li><a href="project-reports.html" title="Project Reports"><span class="icon-chevron-right"></span>Project Reports</a>  </li>
  </ul>
          <hr />
          <div id="poweredBy">
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
  <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" /></a>
              </div>
          </div>
        </div>
        <div id="bodyColumn"  class="span10" >


  
    <div class="section">
<h2><a name="Introduction"></a>Introduction</h2>
      
<div class="section">
<h3><a name="What_is_MyBatis-Spring-Boot-Starter-Test"></a>What is MyBatis-Spring-Boot-Starter-Test?</h3>

        
<p>The MyBatis-Spring-Boot-Starter-Test help creating a test cases for MyBatis component using the <a class="externalLink" href="http://www.mybatis.org/spring-boot-starter/mybatis-spring-boot-autoconfigure/">
          MyBatis-Spring-Boot-Starter</a>.
        </p>

        
<p>By using this module you will can be:</p>

        
<ul>
          
<li>Can use the <tt>@MybatisTest</tt> that setup test components for testing pure MyBatis
            component
          </li>
          
<li>Can import dependency artifacts for performing tests for pure MyBatis component</li>
        </ul>

      </div>

      
<div class="section">
<h3><a name="Requirements"></a>Requirements</h3>
        
<p>
          The MyBatis-Spring-Boot-Starter-Test requires Java 6 or higher and the following Spring Boot version:
        </p>
        
<table border="0" class="table table-striped">
          <thead>
            
<tr class="a">
              
<th>MyBatis-Spring-Boot-Starter-Test</th>
              
<th>Spring Boot</th>
            </tr>
          </thead>
          <tbody>
            
<tr class="b">
              
<td><b>1.3.x (1.3.1)</b></td>
              
<td>1.5 or higher</td>
            </tr>
            
<tr class="a">
              
<td><b>1.2.x (1.2.1)</b></td>
              
<td>1.4</td>
            </tr>
          </tbody>
        </table>
      </div>

      
<div class="section">
<h3><a name="Installation"></a>Installation</h3>
        
<p>
          If you are using Maven just add the following dependency to your <tt>pom.xml</tt>:
        </p>
        
<div class="source"><pre class="prettyprint">
&lt;dependency&gt;
    &lt;groupId&gt;org.mybatis.spring.boot&lt;/groupId&gt;
    &lt;artifactId&gt;mybatis-spring-boot-starter-test&lt;/artifactId&gt;
    &lt;version&gt;2.0.0-SNAPSHOT&lt;/version&gt;
&lt;/dependency&gt;</pre></div>

        
<p>
          If using gradle add this to your <tt>build.gradle</tt>:
        </p>
        
<div class="source"><pre class="prettyprint">
dependencies {
    compile(&quot;org.mybatis.spring.boot:mybatis-spring-boot-starter-test:2.0.0-SNAPSHOT&quot;)
}</pre></div>

      </div>

      
<div class="section">
<h3><a name="Using_MybatisTest"></a>Using @MybatisTest</h3>
        
<p>
          The <tt>@MybatisTest</tt> can be used if you want to test MyBatis components(Mapper interface
          and <tt>SqlSession</tt>).
          By default it will configure MyBatis(MyBatis-Spring) components(<tt>SqlSessionFactory
        </tt> and <tt>SqlSessionTemplate</tt>), configure MyBatis mapper interfaces and configure an
          in-memory embedded database.
          MyBatis tests are transactional and rollback at the end of each test by default, for more details
          refer to the <a class="externalLink" href="http://docs.spring.io/spring/docs/current/spring-framework-reference/htmlsingle/#testcontext-tx-enabling-transactions">
          relevant section in the Spring Reference Documentation</a>.
          Also regular <tt>@Component</tt> beans will not be loaded into the <tt>
          ApplicationContext</tt>.
        </p>

        
<div class="section">
<h4><a name="Test_for_Mapper_interface:"></a>Test for Mapper interface:</h4>

        
<p>
          if you create a test case for following mapper interface, you add just <tt>@MybatisTest</tt> on
          your test case class.
        </p>

        
<p>
          Mapper interface :
        </p>

        
<div class="source"><pre class="prettyprint">
package sample.mybatis.mapper;

import org.apache.ibatis.annotations.Mapper;
import org.apache.ibatis.annotations.Param;
import org.apache.ibatis.annotations.Select;
import sample.mybatis.domain.City;

@Mapper
public interface CityMapper {

    @Select(&quot;SELECT * FROM CITY WHERE state = #{state}&quot;)
    City findByState(@Param(&quot;state&quot;) String state);

}</pre></div>

        
<p>
          TestCase class :
        </p>

        
<div class="source"><pre class="prettyprint">
package sample.mybatis.mapper;

import org.junit.Test;
import org.junit.runner.RunWith;
import org.mybatis.spring.boot.test.autoconfigure.MybatisTest;
import sample.mybatis.domain.City;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.test.context.junit4.SpringRunner;

import static org.assertj.core.api.Assertions.assertThat;

@RunWith(SpringRunner.class)
@MybatisTest
public class CityMapperTest {

    @Autowired
    private CityMapper cityMapper;

    @Test
    public void findByStateTest() {
        City city = cityMapper.findByState(&quot;CA&quot;);
        assertThat(city.getName()).isEqualTo(&quot;San Francisco&quot;);
        assertThat(city.getState()).isEqualTo(&quot;CA&quot;);
        assertThat(city.getCountry()).isEqualTo(&quot;US&quot;);
    }

}</pre></div>

        </div>
<div class="section">
<h4><a name="Test_for_DAO_pattern:"></a>Test for DAO pattern:</h4>

        
<p>
          if you create a test case for following DAO class, you add just <tt>@MybatisTest</tt> and <tt>@Import</tt> on your test case class.
        </p>

        
<p>
          DAO class :
        </p>

        
<div class="source"><pre class="prettyprint">
package sample.mybatis.dao;

import org.apache.ibatis.session.SqlSession;
import sample.mybatis.domain.City;

import org.springframework.stereotype.Component;

@Component
public class CityDao {

    private final SqlSession sqlSession;

    public CityDao(SqlSession sqlSession) {
        this.sqlSession = sqlSession;
    }

    public City selectCityById(long id) {
        return this.sqlSession.selectOne(&quot;selectCityById&quot;, id);
    }

}</pre></div>

        
<p>
          TestCase class :
        </p>

        
<div class="source"><pre class="prettyprint">
package sample.mybatis.dao;

import org.junit.Test;
import org.junit.runner.RunWith;
import org.mybatis.spring.boot.test.autoconfigure.MybatisTest;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.context.annotation.Import;
import org.springframework.test.context.junit4.SpringRunner;
import sample.mybatis.domain.City;

import static org.assertj.core.api.Assertions.assertThat;

@RunWith(SpringRunner.class)
@MybatisTest
@Import(CityDao.class)
public class CityDaoTest {

    @Autowired
    private CityDao cityDao;

    @Test
    public void selectCityByIdTest() {
        City city = cityDao.selectCityById(1);
        assertThat(city.getName()).isEqualTo(&quot;San Francisco&quot;);
        assertThat(city.getState()).isEqualTo(&quot;CA&quot;);
        assertThat(city.getCountry()).isEqualTo(&quot;US&quot;);
    }

}</pre></div>

      </div></div>

      
<div class="section">
<h3><a name="Using_a_real_database"></a>Using a real database</h3>
        
<p>
          The In-memory embedded databases generally work well for tests since they are fast and don&#x2019;t require
          any developer installation.
          However if you prefer to run tests against a real database, you can use the <tt>@AutoConfigureTestDatabase</tt> as follow:
        </p>

        
<div class="source"><pre class="prettyprint">
package sample.mybatis.mapper;
// ...
import org.springframework.boot.test.autoconfigure.jdbc.AutoConfigureTestDatabase;

@RunWith(SpringRunner.class)
@MybatisTest
@AutoConfigureTestDatabase(replace = AutoConfigureTestDatabase.Replace.NONE)
public class CityMapperTest {
    // ...
}</pre></div>

      </div>

      
<div class="section">
<h3><a name="Prevent_detecting_a_real_SpringBootApplication"></a>Prevent detecting a real @SpringBootApplication</h3>
        
<p>
          The <tt>@MybatisTest</tt> will detect a class that annotated <tt>@SpringBootApplication</tt> by
          default.
          Therefore by depend on bean definition methods, there is case that an unexpected error is occurred
          or unnecessary components are loaded into <tt>ApplicationContext</tt>.
          This behavior can prevent by creating a <tt>@SpringBootApplication</tt> class into same package
          as test class as follow:
        </p>

        
<div class="source"><pre class="prettyprint">
package sample.mybatis.mapper;

import org.springframework.boot.autoconfigure.SpringBootApplication;

@SpringBootApplication
class MapperTestApplication {

}</pre></div>
      </div>

      
<div class="section">
<h3><a name="Appendix_A._Imported_auto-configuration"></a>Appendix A. Imported auto-configuration</h3>

        
<p>
          The <tt>@MybatisTest</tt> will import following auto-configuration classes.
        </p>

        
<ul>
          
<li>
            <tt>org.springframework.boot.autoconfigure.cache.CacheAutoConfiguration</tt>
          </li>
          
<li>
            <tt>org.springframework.boot.autoconfigure.flyway.FlywayAutoConfiguration</tt>
          </li>
          
<li>
            <tt>org.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration</tt>
          </li>
          
<li>
            <tt>
              org.springframework.boot.autoconfigure.jdbc.DataSourceTransactionManagerAutoConfiguration
            </tt>
          </li>
          
<li>
            <tt>org.springframework.boot.autoconfigure.jdbc.JdbcTemplateAutoConfiguration</tt>
          </li>
          
<li>
            <tt>org.springframework.boot.autoconfigure.liquibase.LiquibaseAutoConfiguration</tt>
          </li>
          
<li>
            <tt>org.springframework.boot.autoconfigure.transaction.TransactionAutoConfiguration</tt>
          </li>
          
<li>
            <tt>org.mybatis.spring.boot.autoconfigure.MybatisAutoConfiguration</tt>
          </li>
        </ul>

      </div>

      
<div class="section">
<h3><a name="Appendix_B._Running_Samples"></a>Appendix B. Running Samples</h3>
        
<p>
          The project provides two samples so you play and experiment with them.
        </p>

        
<table border="0" class="table table-striped">
          <thead>
            
<tr class="a">
              
<th>
                Sample
              </th>
              
<th>
                Description
              </th>
            </tr>
          </thead>
          <tbody>
            
<tr class="b">
              
<td>
                <a class="externalLink" href="https://github.com/mybatis/spring-boot-starter/tree/master/mybatis-spring-boot-samples/mybatis-spring-boot-sample-annotation">
                  1st Sample
                </a>
              </td>
              
<td>
                Show the simplest scenario with just a mapper and a bean where the mapper is injected
                into. This is the sample we saw in the Quick Setup section.
              </td>
            </tr>
            
<tr class="a">
              
<td>
                <a class="externalLink" href="https://github.com/mybatis/spring-boot-starter/tree/master/mybatis-spring-boot-samples/mybatis-spring-boot-sample-xml">
                  2nd Sample
                </a>
              </td>
              
<td>
                Shows how to use a Mapper that has its statements in an xml file and DAO that uses
                an <tt>SqlSesionTemplate</tt>.
              </td>
            </tr>
          </tbody>
        </table>

      </div>
    </div>
  


        </div>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>Copyright &copy;2015&#x2013;2017
<a href="http://www.mybatis.org/">MyBatis.org</a>.
All rights reserved.</p>
        </div>
        </div>
    </footer>
    </body>
</html>
